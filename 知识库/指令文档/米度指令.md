---
NotionID-ob2notion: 1a7038ef-a6c2-8188-9108-f3956d35a261
link-ob2notion: https://www.notion.so/1a7038efa6c281889108f3956d35a261
---




### 说明：
配置命令均以`##`开头，`\r\n`结尾；配置应答均以`$$`开头，`\r\n`结尾。命令和应答均以ASCII码显示。
以下描述的采集器类型、传感器类型对应的编号，见附录

## 1. 系统参数配置与查询
### 1.1 获取基础配置信息
```
命令：##000\r\n
应答：$$000,SN-L,(1),(2),(3),(4),(5),(6),(7),(8),(9),(10),(11),(12),(13),(14),(15),(16),(17),(18)\r\n

参数说明：
(1) 本地北斗卡号：六位十进制数
(2) 目标北斗卡号：六位十进制数
(3) 设备状态：1-待机；2-激活
(4) 数据通讯模式：1-GPRS；2-SMS；3-BD
(5) 雨量站：1-开启；2-关闭
(6) 雨量计精度：（单位 0.01mm）
(7) 定位灵敏度
(8) 定位精度
(9) 心跳包时间间隔：（单位 s，为0表示关闭心跳功能）
(10) 调试口波特率
(11) 传感器波特率
(12) 采集器型号：00-VW08，02-DS08，04-CX08，07-RD08,08-SMC08，12-TH08，20-VW01
(13) 数据上报间隔：（单位 min）
(14) 电池过放保护：（单位 V）
(15) 调试模式：0-初始化，1-关闭，2-DEBUG，3-INFO
(16) 传感器接口类型：1-RS485接口，2-SDI12接口
(17) 数据传输协议：2-MDM协议，4-MQTT协议
(18) SIM卡选择：0-贴片卡，1-SIM卡1，2-SIM卡2
```

### 1.2 获取信号强度
```
命令：##014\r\n
应答：$$014,(1),(2),(3),(4),(5),(6),(7),(8),(9),(10)\r\n

参数说明：
(1) 信号值
(2) GPS定位搜星数目
(3) 启动代码
(4) 重启代码
(5) sim卡ccid
(6) 设备内部温度
(7) 设备内部电池电压
(8) 设备外部电压
(9) 运营商类型
(10) 网络制式
```

### 1.3 获取版本信息
```
命令：##040\r\n
应答：$$040,(1),(2),(3)\r\n

参数说明：
(1) 产品序列号
(2) 固件版本号
(3) 生产日期
```

### 1.4 查询设备状态1
```
命令：##041\r\n
应答：$$041,(1),(2),(3),(4),(5),(6)\r\n

参数说明：
(1) SN号
(2) IMEI号
(3) SIM卡号
(4) 启动代码1
(5) 启动代码2
(6) 信号强度：1~11为1格信号，12~18为2格信号，19~25为3格信号，26~31为4格信号

示例：
$$041,150000L,865860047575320,898604061918C0643348,20,1,9
```

### 1.5 查询设备状态2
```
命令：##042\r\n
应答：$$042,(1),(2),(3),(4),(5),(6),(7),(8),(9),(10),(11),(12),(13),(15),(16),(17),(18)\r\n

参数说明：
(1) SN号
(2) 经度
(3) 纬度
(4) 设备内部电压
(5) 设备外部电压
(6) 太阳能控制器状态
(7) 太阳能板电压
(8) 电池电压
(9) 日发电量
(10) 日耗电量
(11) 机箱内部温湿度状态
(12) 机箱内部温度
(13) 机箱内部湿度
(14) 机箱外部温湿度状态
(15) 机箱外部温度
(16) 机箱外部湿度
(17) 开关量类型：1-雨量计，2-关闭，3-断线报警器
(18) 降雨量或断线报警器状态(1:断开，0：闭合)

示例：
$$042,150000L,0.000000,0.000000,8.4,11.9,0,1.1,11.9,0.0,0.0,0,23.1,35.9,0,23.8,35.1,2,0.0
```

### 1.6 查询设备状态3
```
命令：##043\r\n
应答：$$043,(1),(2),(3),(4),(5)\r\n

参数说明：
(1) SN号
(2) 采集器型号
(3) 采集器地址(当采集器地址为0时，关闭采集功能)
(4) 传感器状态：用冒号分隔的字符串 ①:②:③
    ①：传感器地址
    ②：传感器状态，0正常，1异常
    ③：传感器数据
(5) 传感器状态，和(4)格式相同

注：传感器状态可能有很多个，由接入传感器个数决定

示例：
$$043,150000L,2,1,3:0:3.1,5:0:3.1\r\n
```

### 1.7 查询网络状态
```
命令：##044n\r\n  (n取值1，2，3)
应答：$$044n,(1),(2),(3),(4),(5),(6),(7),(8),(9),(10)\r\n

参数说明：
(1) 已发送数据
(2) 已生成数据
(3) flash使能：0-未使能，1-使能
(4) flash读指针
(5) flash写指针
(6) 链路使能：0-未使能，1-使能
(7) 链路状态：0-未上线，1-已上线
(8) 4G模块状态
(9) MQTT状态
(10) 在线率（单位%）

示例：
$$0441,7,7,1,0x001000D4,0x001000D4,1,1,4,7,93.6
```

### 1.8 查询太阳能控制器参数
```
命令：##045\r\n
应答：$$045,(1),(2),(3),(4),(5),(6),(7),(8),(9),(10),(11),(12),(13),(14),(15),(16),(17)\r\n

参数说明：
(1) SN号
(2) 链路1读指针
(3) 链路1写指针
(4) 链路2读指针
(5) 链路2写指针
(6) 链路3读指针
(7) 链路3写指针
(8) 时间是否可用
(9) 4G模块工作状态
(10) 传感器初始值是否可用
(11) 传感器初始值
(12) 日发电量
(13) 日耗电量
(14) 月发电量
(15) 月耗电量
(16) 年发电量
(17) 年耗电量
```

### 1.9 设置六位目标北斗卡号
```
命令：##001XXXXXX\r\n
应答：$$001XXXXXX\r\n

示例：
设置目标北斗卡号455872
命令：##001455872\r\n
应答：$$001455872\r\n
```

### 1.10 设置数据通讯模式
```
命令：##003x\r\n
应答：$$003x\r\n

参数说明：
x=1：GPRS模式
x=2：短信息模式
x=3：北斗短报文模式
x=4：GPRS/北斗

示例：
选择GPRS模式通讯
命令：##0031\r\n
应答：$$0031\r\n
```

### 1.11 设置工作模式
```
命令：##006x\r\n
应答：$$006x\r\n

参数说明：
x=0：初始化模式
x=1：工作模式
x=2：DEBUG模式
x=3：INFO模式
```

### 1.12 设置北斗电源开关
```
命令：##007x\r\n
应答：$$007x\r\n

参数说明：
x=1：打开电源开关
x=2：关闭电源开关
```

### 1.13 重启设备
```
命令：##008x...x\r\n
应答：$$008x...x\r\n

参数说明：
x...x：重启等待时间（单位s，最大支持4位数字）

示例：
1s后重启设备
命令：##0081\r\n
应答：$$0081\r\n
```

### 1.14 设置本地时间
```
命令：##010xxxxxxxxxxxx\r\n
应答：$$010xxxxxxxxxxxx\r\n

参数说明：
xxxxxxxxxxxx：年月日时分秒（各两位）

示例：
设置本地时间为2015/5/26 10:22:1
命令：##010150526102201
应答：$$010150526102201

注：##010\r\n可查询系统时间
```

### 1.15 设置心跳包发送间隔
```
命令：##013x...x\r\n
应答：$$013x...x\r\n

参数说明：
x...x：单位s，最大86400即24小时，为0表示关闭心跳包

示例：
设置心跳包为3600s
命令：##0133600\r\n
应答：$$0133600\r\n
```

### 1.16 设置电池过放保护电压
```
命令：##015x...x\r\n
应答：$$013x...x\r\n

参数说明：
x...x：电压值（单位V，当电池电压低于该值，设备进入待机模式）

示例：
设置保护电压为13.5V
命令：##01513.5\r\n
应答：$$01313.5\r\n
```

### 1.17 设置GPS定位
```
命令：##016xxY...Y\r\n
应答：$$016xxY...Y\r\n

参数说明：
xx>00：开启，xx表示定位灵敏度，Y...Y定位精度（单位m，最长支持6位数字）
xx=00：关闭，Y...Y选填

示例：
打开GPS定位功能
命令：##01600\r\n
应答：$$01600\r\n
```

### 1.18 设置低功耗模式
```
命令：##018x\r\n
应答：$$018x\r\n

参数说明：
x=1：待机
x=2：激活

示例：
激活设备
命令：##0182\r\n
应答：$$0182\r\n
```

### 1.19 保存系统参数
```
命令：##019x\r\n
应答：$$019x\r\n

参数说明：
x=1：保存参数，并重启设备
x=2：保存参数，不重启设备
```

### 1.20 设置传感器接口类型
```
命令：##020x\r\n
应答：$$020x\r\n

参数说明：
x=1：RS485接口
x=2：SDI-12接口

示例：
设置接口类型为RS485
命令：##0201\r\n
应答：$$0201\r\n
```

### 1.21 设置数据传输协议
```
命令：##030x\r\n
应答：$$030x\r\n

参数说明：
x=2：MDM协议
x=4：MQTT协议
```

### 1.22 设置传感器口波特率
```
命令：##114x\r\n
应答：$$114x\r\n

参数说明：
x可选值：1200、2400、4800、9600、19200、57600、115200

示例：
设置波特率为9600
命令：##1149600\r\n
应答：$$1149600\r\n
```

### 1.23 设置远程升级
```
命令：##120xY...Y\r\n
应答：$$120xY...Y\r\n

参数说明：
x=0：关闭升级模式，Y...Y选填
x=1：打开升级模式，Y...Y为升级服务器端口号（最长支持5位数字）
x=2：打开升级模式，Y...Y为服务器地址和端口，用空格分割

示例：
打开升级模式，升级服务器端口为12306
命令：##120112306\r\n
应答：$$120112306\r\n

示例2：
命令：##1202 test.shmedo.cn 9001
```

### 1.24 设置数据上报间隔
```
命令：##143x...x\r\n
应答：$$143x...x\r\n

参数说明：
x...x：单位min，最长支持5位数字

示例：
设置数据上报间隔为60min
命令：##14360\r\n
应答：$$14360\r\n
```

### 1.25 即时采集
```
命令：##110\r\n
应答：$$110\r\n
```

### 1.26 恢复出厂设置
```
命令：##119\r\n
应答：$$119\r\n
```

## 2. 传感器参数配置与查询

### 2.1 获取采集器配置
```
命令：##100XX\r\n
应答：$$100XX,(1),(2),(3),(4),(5)\r\n

参数说明：
XX：采集器型号
(1) 采集器地址
(2) 待机时长（单位s）
(3) 工作时长（单位s）
(4) 采集间隔（单位ms）
(5) 接入总数
```

### 2.2 获取采集器通道传感器参数
```
命令：##101XXYY\r\n
应答：$$101XXYY,(1),(2),(3)...\r\n

参数说明：
XX：采集器型号
YY：通道号，由接入总数N决定，YY取值为00,01,...,N-1
(1) 传感器地址/通道号
(2) 传感器类型

后续参数根据传感器类型不同而不同：

拉线位移计：
(3) 触发阈值
(4) 修正值（单位m）

测斜仪：
(3) 触发阈值
(4) 测段长（单位mm）
(5) 修正值（单位m）

墒情计：
(3) 湿度触发阈值
(4) 湿度修正值
(5) 盐分触发阈值
(6) 盐分修正值
(7) 温度触发阈值
(8) 温度修正值

基康渗压计：
(3) 触发阈值
(4) 多项式系数A
(5) 多项式系数B
(6) 多项式系数C
(7) 温度系数K
(8) 初始温度T0
(9) 手动纠偏

葛南渗压计、土压力计、侧缝计：
(3) 触发阈值
(4) 灵敏度K
(5) 温度系数b
(6) 基准值F0
(7) 初始温度T0
(8) 手动纠偏

葛南应力计、无应力计：
(3) 触发阈值
(4) 灵敏度K
(5) 温度系数b
(6) 膨胀系数α
(7) 基准值F0
(8) 初始温度T0
(9) 手动纠偏
```

### 2.3 设置开关量
```
命令：##005x\r\n
应答：$$005x\r\n

参数说明：
x=1：开启雨量站模式
x=2：关闭
x=3：开启断线报警器

示例：
打开雨量站
命令：##0051\r\n
应答：$$0051\r\n
```

### 2.4 设置断线报警器工作模式
```
命令：##227x\r\n
应答：$$227x\r\n

参数说明：
x=0：查询
x=1：常开模式
x=2：常闭模式

示例：
查询断线报警器状态
命令：##2270\r\n
应答：$$22711\r\n
```

### 2.5 设置雨量计精度
```
命令：##121x...x\r\n
应答：$$121x...x\r\n

参数说明：
x...x：单位0.01mm，最长支持5位数字
例如：x...x的值为50，则对应精度为0.5mm

示例：
命令：##12150\r\n
应答：$$12150\r\n
```

### 2.6 设置采集器地址
```
命令：##147x...x\r\n
应答：$$147x...x\r\n

参数说明：
x...x：采集器地址，最长支持5位数字

示例：
设置采集器地址为1
命令：##1471\r\n
应答：$$1471\r\n
```

### 2.7 设置采集器接入的传感器
```
命令：##150zzxxXXXX\r\n
应答：$$150zzxxXXXX\r\n

参数说明：
zz：采集器型号
xx：取值范围为01~08，表示接入传感器的个数
XXXX：根据传感器个数确定长度
- 当传感器个数为01时，XXXX（4个字节）含义：
  前两位表示地址或者通道号，后两位表示接入传感器类型
- 当传感器个数为02时，XXXXXXXX（8个字节）含义：
  前四位表示第一个地址和对应的传感器类型，后四位表示第二个地址和对应的传感器类型

注：该指令不定长，根据接入传感器的个数而定，地址为01~99，通道为00~07
```

### 2.8 设置采集器待机时长
```
命令：##160xxXXXX\r\n
应答：$$160xxXXXX\r\n

参数说明：
xx：表示采集器类型
XXXX：表示时间刻度（单位s）

示例：
设置裂缝采集器的待机时长为60s
命令：##161020060\r\n
应答：$$161020060\r\n
```

### 2.9 设置采集器采集频度
```
命令：##161xxXXXXX\r\n
应答：$$161xxXXXXX\r\n

参数说明：
xx：表示采集器类型
XXXXX：表示时间间隔（单位ms）

示例：
裂缝采集器的采集频度为1s
命令：##1610201000\r\n
应答：$$1610201000\r\n
```

### 2.10 设置采集器解算频度
```
命令：##163xxXXXX\r\n
应答：$$163xxXXXX\r\n

参数说明：
xx：表示采集器类型
XXXX：表示时间间隔（单位s）

示例：
裂缝采集器的解算频度为10s
命令：##163020010\r\n
应答：$$163020010\r\n
```

### 2.11 设置采集器接入传感器的触发阈值
```
命令：##162xxX...X\r\n
应答：$$162xxX...X\r\n

参数说明：
xx：表示采集器类型
X...X：表示阈值，X...X由接入传感器数量N决定（4*N）
单位由传感器类型决定

示例：
裂缝采集器接入两只拉线位移计，触发阈值分别30mm、40mm
命令：##1620200300040\r\n
应答：$$1620200300040\r\n
```

### 2.12 设置采集器接入传感器触发阈值（墒情采集器专用）
```
命令：##168xxYYa...a,b...b,c...c\r\n
应答：$$168xxYYa...a,b...b,c...c\r\n

参数说明：
xx：表示采集器类型
YY：表示地址/通道号
a...a：湿度触发阈值
b...b：盐分触发阈值
c...c：温度触发阈值
```

### 2.13 设置采集器接入传感器修正值
```
命令：##165xxYYa...a,b...b,c...c\r\n
应答：$$165xxYYa...a,b...b,c...c\r\n

参数说明：
xx：表示采集器类型
YY：表示地址/通道号
若为墒情采集器：
a...a：湿度修正值
b...b：盐分修正值
c...c：温度修正值

注：其他传感器只用到一个修正值
```

### 2.14 设置测斜仪测段长
```
命令：##166xxXXXXX\r\n
应答：$$166xxXXXXX\r\n

参数说明：
xx：表示传感器类型
X...X：表示测段长，X...X由接入传感器数量N决定（5*N）
单位：MM

示例：
测斜采集器接入三只测斜仪，测段长分别是1m，2m，3m
命令：##16604001000002000003000\r\n
应答：$$16604001000002000003000\r\n
```

### 2.15 设置振弦式传感器修正参数
```
命令：##167xxXx...x\r\n
应答：$$167xxXx...x\r\n

参数说明：
xx：表示模拟量传感器接入的采集器的通道号，取值00~07
X：表示修正参数类型，取值'A'，'B'，'C'，'K'，'M'
x...x：为长度不确定的参数，可以为小数
```

### 2.16 开启/关闭数字式渗压计功能
```
命令：##401x\r\n
应答：$$401x\r\n

参数说明：
x取值1/2

示例：
开启数字式渗压计接入功能
命令：##4011\r\n
应答：$$4011\r\n
```

### 2.17 设置数字渗压计地址
```
命令：##402x...x\r\n
应答：$$402x...x\r\n

参数说明：
x...x：取值1~255

示例：
设置地址为1
命令：##4021\r\n
应答：$$4021\r\n
```

### 2.18 设置数字渗压计深度触发值和温度触发值
```
命令：##403x...x,y...y\r\n
应答：$$403x...x,y...y\r\n

参数说明：
x...x：深度触发值，1~65535，单位mm
y...y：温度触发值，1~65535，单位℃

示例：
设置深度触发值为10mm，温度触发值为10℃
命令：##40310,10\r\n
应答：$$40310,10\r\n
```

### 2.19 设置数字渗压计深度修正值和温度修正值
```
命令：##404x...x,y...y\r\n
应答：$$404x...x,y...y\r\n

参数说明：
x...x：深度触发值，单位m
y...y：温度触发值，单位℃

示例：
设置深度修正值为-1.2m，温度修正值为10.5℃
命令：##404-1.2,10.5\r\n
应答：$$404-1.2,10.5\r\n
```

### 2.20 设置渗压计绳长
```
命令：##405x...x\r\n
应答：$$405x...x\r\n

参数说明：
x...x：绳长，单位m

示例：
设置绳长为1.2m
命令：##4051.2\r\n
应答：$$4051.2\r\n
```

## 3. 数据中心参数配置和查询

### 3.1 获取服务器地址
```
命令：##200x\r\n
应答：$$200x\r\n

参数说明：
x=1：获取服务器1的地址和端口
x=2：获取服务器2的地址和端口
x=3：获取服务器3的地址和端口
```

### 3.2 获取授权手机号码
```
命令：##204x\r\n
应答：$$204x\r\n
```

### 3.3 设置服务器地址和端口
```
命令：##201x Y...Y z...z\r\n
应答：$$201x Y...Y z...z\r\n

参数说明：
x：表示服务器编号，取值1,2,3
Y...Y：服务器地址（可以为IP或域名）
z...z：服务器端口（最大65535）
注：x，Y，z之间由空格隔开

示例：
设置服务器1的地址test.shmedo.cn端口9001
命令：##2011 test.shmedo.cn 9001\r\n
应答：$$2011 test.shmedo.cn 9001\r\n
```

### 3.4 设置授权手机号码
```
命令：##203x...x\r\n
应答：$$203x...x\r\n

参数说明：
x...x：手机号码（最长支持20位数字）
最大支持3个，号码之间用逗号隔开

示例：
设置授权号码为18512345678和18512345679
命令：##20318512345678,18512345679\r\n
应答：$$20318512345678,18512345679\r\n
```

### 3.5 网络链路通信协议
```
命令：
设置：##202nX\r\n
查询：##2020\r\n

参数说明：
n：表示链路编号，取值1，2，3
X：取值2(MDM协议)，4(mqtt自动注册)，5(mqtt手动注册)
```

### 3.6 自动注册平台选择
```
命令：
设置：##810nX\r\n
查询：##8100\r\n

参数说明：
n：表示链路编号，取值1，2，3
X：取值0（地大平台），1（成都理工平台）2（米度平台）
```

### 3.7 自动注册平台参数
```
命令：
设置：##803nX...X,Y...Y,Z...Z\r\n
查询：##804n\r\n

参数说明：
n：表示链路编号，取值1，2，3
X...X：表示设备SN号
Y...Y：表示产品ID
Z...Z：表示注册码
```

### 3.8 自动注册服务器地址端口
```
命令：
设置：##807n 服务器地址端口\r\n
查询：##808n\r\n

参数说明：
n：表示链路编号，取值1，2，3
```

### 3.9 手动注册平台参数
```
命令：
设置：##805nX...X,Y...Y,Z...Z\r\n
查询：##806n\r\n

参数说明：
n：表示链路编号，取值1，2，3
X...X：表示产品ID
Y...Y：表示设备ID
Z...Z：表示设备KEY
```

### 3.10 MQTTKeepAlive值
```
命令：
设置：##809nX...X\r\n
查询：##8090\r\n

参数说明：
n：表示链路编号，取值1，2，3
X...X：取值[120,65535]，单位s
```

### 3.11 选择平台
```
命令：
设置：##810nX\r\n
查询：##8100\r\n

参数说明：
n：表示链路编号，取值1，2，3
X：取值0（地大平台），1（成都理工平台）2（米度平台）
```

### 3.12 appKey(米度/北京平台特有)
```
命令：
设置：##811nX...X\r\n
查询：##812n\r\n

参数说明：
n：表示链路编号，取值1，2，3
X...X：平台appKey
```

### 3.13 查询数据中心参数
```
命令：##889n\r\n
应答：##889n,(1),(2),(3),(4),(5),(6),(7),(8),(9),(10),(11),(12),(13)\r\n

参数说明：
n：表示链路编号，取值1，2，3

返回参数：
(1) 数据中心开关，0：关闭，1：打开
(2) 通讯协议，2：MDM协议，4：MQTT自动注册，5：MQTT手动注册
(3) 数据平台地址
(4) keepAlive
(5) 设备SN号
(6) 产品ID
(7) 注册码
(8) 注册平台类型，0：地大平台，1：成都理工平台，2：米度平台
(9) 注册平台地址
(10) APPKey
(11) MQTT设备ID
(12) MQTT用户名
(13) MQTT密码

注：不同通讯协议下的参数不一致，不存在的参数，逗号之间为空
```

## 附录

### 表1 传感器信息
| 传感器名称 | 传感器型号 | 传感器编号 |
|------------|------------|------------|
| 拉线位移计 | MPS-M-2000 | 02 |
| 土壤含水率 | TR-3000 | 03 |
| 测斜仪 | I-P-I | 04 |
| 超声波物位计 | HBRD908 | 06 |
| 雷达物位计 | MH-A15R | 07 |
| 墒情计 | EP100G | 08 |
| 温湿度计 | CSW18 | 12 |
| 扬压力计 | VWP-G | 15 |
| 基康渗压计 | BGK-4500 | 50 |
| 葛南渗压计 | VWP-03 | 51 |
| 葛南土压力盒 | VWE-0.6 | 52 |
| 葛南应力计 | VWS-15 | 53 |
| 葛南无应力计 | VWS-15M | 54 |
| 葛南位移计 | VWD-100 | 55 |

### 表2 采集器信息
| 采集器名称 | 采集器型号 | 采集器编号 |
|------------|------------|------------|
| 采集器 | VW08 | 00 |
| 裂缝计采集器 | DS08 | 02 |
| 土壤湿度采集器 | HD08 | 03 |
| 测斜仪采集器 | CX08 | 04 |
| 超声波采集器 | UDS08 | 06 |
| 雷达采集器 | RD08 | 07 |
| 墒情采集器 | SMC08 | 08 |
| 温湿度采集器 | TH08 | 12 |
| 数字式渗压计采集器 | DVWP | 15 |
| 单通道采集器 | VW01 | 20 |