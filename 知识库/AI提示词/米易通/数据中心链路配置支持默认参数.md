# 米易通APP开发需求文档开发需求文档

## 链路配置

### 所有的平台类型配置通用参数 
| 序号 | 原名称 | 现在名称 | plattype | IP | 端口 | 协议 | 备注 |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | 地大平台 | 地大平台 | 0 | | | | 取消 |
| 2 | 中移物联平台 | 中移物联平台 | 1 | | | | 取消 |
| 3 | 米度物联平台 | 米度物联平台 | 2 | | | MQTT | |
| 4 | 地大平台2 | 贵州地灾平台 | 3 | iot.gz1155.cn | 1883 | MQTT | 拆分 |
| 5 | 地大平台2 | 广西地灾平台 | 3 | 218.65.206.87 | 1883 | MQTT | 拆分 |
| 6 | 地大平台2 | 云南地灾平台 | 3 | 222.221.241.110 | 1883 | MQTT | 拆分 |
| 7 | 河南水利平台 | 河南水文平台 | 4 | data.skaqjc.cn | 9888 | SL651 | 拆分 |
| 8 | 河南水利平台 | 河南大坝监测平台 | 4 | data.skaqjc.cn | 1883 | MQTT | 拆分 |
| 9 | 米度水文平台 | 米度水文平台 | 5 | | | | 取消 |
| 10 | AMS解算平台 | AMS解算平台 | 6 | 默认空 | 默认空 | | |
| 11 | 重庆地灾平台 | 重庆地灾平台 | 7 | 183.66.66.31 | 1883 | MQTT | |
| 12 | 广东水文平台 | 广东水文平台 | 8 | iot.gdwater.gov.cn | 8883 | MQTTS | |
| 13 | 广西水文平台 | 广西水文平台 | 9 | 222.216.6.174 | 8076 | SL651 | |
| 14 | 湖北水文平台 | 湖北水文平台 | 10 | 183.95.190.143 | 9095 | SL651 | |
| 15 | 湖北生态流量平台 | 湖北生态流量平台 | 11 | 183.95.190.143 | 8094 | SZY206 | |
| 16 | 贵州加密平台 | 贵州加密平台 | 12 | 默认空 | 默认空 | MQTT | |
| 17 | CORS平台 | CORS平台 | 13 | 默认空 | 默认空 | Ntrip | |
| 18 | 北京路安平台 | 北京路安平台 | 14 | 120.46.221.231 | 2443 | MQTT | |
| 19 | 广东山洪预警平台 | 广东山洪预警平台 | 15 | 8.134.151.187 | 8069 | Http | |


### 智能遥测终端机MR702产品支持的平台类型详细默认参数
#### 米度物联平台 
`$cmd=md_mrsetdatacenter&centerid=1&switch=1&line=1&level=1&type=1&addr=47.96.80.48&port=1883&plattype=2&datatype=1&projid=24A0003CR2&deviceid=280103&devicekey=9af7ba3a-2b70-4631-8639-cc1a29bd2b4a&regcode=0d4b5ee1-472c-4352-883e-ed012e725b2f&httpaddr=47.96.80.48&httpport=80&keepalive=30` 

| 功能名称 | 指令字段 | 说明 | 默认值 |
| :--- | :--- | :--- | :--- |
| 链路启用 | switch | 1:开启，0:关闭 | 0 |
| 平台类型 | plattype | | 2 |
| 链路地址 | addr | | 47.96.80.48 |
| 链路端口 | port | | 1883 |
| 通信方式 | line | 1:4G，2:有线 | 1 |
| 网络协议 | level | 1:ipv4，2:ipv6 | 1 |
| 传输协议 | type | 1:TCP，2:UDP | 1 |
| 数据协议 | datatype | 1:MQTT ,2:TCP-C ,3:SL651 ,4:SZY206,5:MQTTS | 1 |
| 产品ID | projid | | 请输入 |
| 设备ID | deviceid | | 请输入 |
| 设备key | devicekey | | 请输入 |
| 设备注册码 | regcode | | 0d4b5ee1-472c-4352-883e-ed012e725b2f |
| 设备注册地址 | httpaddr | | 47.96.80.48 |
| 设备注册端口 | httpport | | 80 |
| 心跳间隔（秒） | keepalive | | 30 |


#### 广水文平台
`$cmd=md_mrsetdatacenter&centerid=3&switch=1&line=1&level=1&type=1&addr=iot.gdwater.gov.cn&port=8883&plattype=8&datatype=5&projid=n3oBLRgSG2&deviceid=24A0003&devicekey=87Q4yqVTFWVcwyQ5yrl4Z+2oDM/5FuPepeqepkx0m1o=&regcode=87Q4yqVTFWVcwyQ5yrl4Z+2oDM/5FuPepeqep&httpaddr=iot.gdwater.gov.cn&httpport=1667&packtype=0&taddress=24A0003` 

**注意**：当前APP为配置taddress参数，需要增加上。 

| 功能名称 | 指令字段 | 说明 | 默认值 |
| :--- | :--- | :--- | :--- |
| 链路启用 | switch | 1:开启，0:关闭 | 0 |
| 平台类型 | plattype | | 8 |
| 链路地址 | addr | | iot.gdwater.gov.cn |
| 链路端口 | port | | 8883 |
| 通信方式 | line | 1:4G，2:有线 | 1 |
| 网络协议 | level | 1:ipv4，2:ipv6 | 1 |
| 传输协议 | type | 1:TCP，2:UDP | 1 |
| 数据协议 | datatype | 1:MQTT ,2:TCP-C ,3:SL651 ,4:SZY206,5:MQTTS | 5 |
| 测站类型 | packtype | Packtype=0山洪灾害监测站,Packtype=1河道水情监测站,Packtype=3沉降监测站,Packtype=4水质监测站,Packtype=5雨量监测站,Packtype=6流量监测站 ,Packtype=7北斗山洪灾害监测站 | 0 |
| 测站编码 | taddress | | 请输入 |
| 产品ID | projid | | 请输入 |
| 设备ID | deviceid | | 请输入 |
| 设备key | devicekey | | 请输入 |
| 设备注册码 | regcode | | a1b2c3d4e5f6g7h8 |
| 设备注册地址 | httpaddr | | 0.0.0.0 |
| 设备注册端口 | httpport | | 1667 |
| 心跳间隔（秒） | keepalive | | 30 |


#### 广西水文平台
`$cmd=md_mrsetdatacenter&centerid=2&switch=1&line=1&level=1&type=1&addr= 222.216.6.174 &port= 8076 &plattype=9&datatype=3&type_code=K&co_address=251&password=40960&taddress=00123F456&timed_report=1&hour_report=1&add_report=1&maintain_report=0&valid_day=180&reissue_time=30&keepalive=30` 

| 功能名称 | 指令字段 | 说明 | 默认值 |
| :--- | :--- | :--- | :--- |
| 链路启用 | switch | 1:开启，0:关闭 | 0 |
| 平台类型 | plattype | | 9 |
| 链路地址 | addr | | 222.216.6.174 |
| 链路端口 | port | | 8076 |
| 通信方式 | line | 1:4G，2:有线 | 1 |
| 网络协议 | level | 1:ipv4，2:ipv6 | 1 |
| 传输协议 | type | 1:TCP，2:UDP | 1 |
| 数据协议 | datatype | 1:MQTT ,2:TCP-C ,3:SL651 ,4:SZY206,5:MQTTS | 3 |
| 测站分类 | type_code | | K |
| 中心站地址 | co_address | | 请输入 |
| 密码 | password | | 请输入 |
| 测站编码 | taddress | | 请输入 |
| 小时报 | timed_report | 0:不启用，1：启用 | 1 |
| 定时报 | hour_report | 0:不启用，1：启用 | 1 |
| 加报报 | add_report | 0:不启用，1：启用 | 0 |
| 维持报 | maintain_report | 0:不启用，1：启用 | 1 |
| 维持上报间隔（秒） | keepalive | | 30 |
| 数据补发有效时间（日） | valid_day | | 180 |
| 数据补发间隔（分钟） | reissue_time | | 30 |


#### 湖北水文平台 
`$cmd=md_mrsetdatacenter&centerid=2&switch=1&line=1&level=1&type=1&addr= 183.95.190.143 &port= 9095 &plattype=10&datatype=3&type_code=K&co_address=251&password=40960&taddress=00123F456&timed_report=1&hour_report=1&add_report=1&maintain_report=0&valid_day=180&reissue_time=30&keepalive=30`

| 功能名称 | 指令字段 | 说明 | 默认值 |
| :--- | :--- | :--- | :--- |
| 链路启用 | switch | 1:开启，0:关闭 | 0 |
| 平台类型 | plattype | | 10 |
| 链路地址 | addr | | 183.95.190.143 |
| 链路端口 | port | | 9095 |
| 通信方式 | line | 1:4G，2:有线 | 1 |
| 网络协议 | level | 1:ipv4，2:ipv6 | 1 |
| 传输协议 | type | 1:TCP，2:UDP | 1 |
| 数据协议 | datatype | 1:MQTT ,2:TCP-C ,3:SL651 ,4:SZY206,5:MQTTS | 3 |
| 测站分类 | type_code | | K |
| 中心站地址 | co_address | | 请输入 |
| 密码 | password | | 请输入 |
| 测站编码 | taddress | | 请输入 |
| 小时报 | timed_report | 0:不启用，1：启用 | 1 |
| 定时报 | hour_report | 0:不启用，1：启用 | 1 |
| 加报报 | add_report | 0:不启用，1：启用 | 0 |
| 维持报 | maintain_report | 0:不启用，1：启用 | 1 |
| 维持上报间隔（秒） | keepalive | | 30 |
| 数据补发有效时间（日） | valid_day | | 180 |
| 数据补发间隔（分钟） | reissue_time | | 30 |


#### 湖北生态流量平台
`$cmd=md_mrsetdatacenter&centerid=2&switch=1&line=1&level=1&type=1&addr=183.95.190.143&port=8094&plattype=11&datatype=4&password=40960&taddress=422326f803&timed_report=1&hour_report=1&add_report=1&maintain_report=1&valid_day=180&reissue_time=30&keepalive=30` 

| 功能名称 | 指令字段 | 说明 | 默认值 |
| :--- | :--- | :--- | :--- |
| 链路启用 | switch | 1:开启，0:关闭 | 0 |
| 平台类型 | plattype | | 11 |
| 链路地址 | addr | | 183.95.190.143 |
| 链路端口 | port | | 8094 |
| 通信方式 | line | 1:4G，2:有线 | 1 |
| 网络协议 | level | 1:ipv4，2:ipv6 | 1 |
| 传输协议 | type | 1:TCP，2:UDP | 1 |
| 数据协议 | datatype | 1:MQTT ,2:TCP-C ,3:SL651 ,4:SZY206,5:MQTTS | 4 |
| 密码 | password | | 请输入 |
| 测站编码 | taddress | | 请输入 |
| 小时报 | timed_report | 0:不启用，1：启用 | 1 |
| 定时报 | hour_report | 0:不启用，1：启用 | 1 |
| 加报报 | add_report | 0:不启用，1：启用 | 1 |
| 维持报 | maintain_report | 0:不启用，1：启用 | 1 |
| 维持上报间隔（秒） | keepalive | | 30 |
| 数据补发有效时间（日） | valid_day | | 180 |
| 数据补发间隔（分钟） | reissue_time | | 30 |


### 具体需求：
1. 配置设备的链路时提供默认平台类型默认参数，减少用户的输入成本
  - 目前优先实现给智能遥测终端机MR702产品的链路配置增加默认平台类型默认参数
    - MR702 只支持 《所有平台配置》中的序号 3(米度物联平台)、12(广东水文平台)、13(广西水文平台)、14(湖北水文平台)、15(湖北生态流量平台) 的平台配置


## Claude Code 提示词
'/Users/gonghe/Work/CompanyProject/mCloudapp_V5/app/src/main/java/com/shmedo/mcloudapp/ui/page/device/collector_product/fragment/mr702/MR702DataCenterParamFragment.kt' 
'/Users/gonghe/Downloads/链路默认参数开发需求.md'
'/Users/gonghe/Work/CompanyProject/mCloudapp_V5/app/src/main/java/com/shmedo/mcloudapp/ui/page/device/common/UniversalDataCenterParamFragment.kt'

   MR702DataCenterParamFragment.kt 是智能遥测终端机MR702产品的链路配置参数页面,因为配置参数众多,所以为减少用户的输入成本，所以需要提供默认平台类型默认参数，请你阅读相关文件，并根据 链路默认参数开发需求.md 文件内容，提供实现配置设备的链路时提供默认平台类型默认参数的详细方案，方案需要保持扩展性，后期还要优化 UniversalDataCenterParamFragment 来支持配置其他产品设备时也支持默认平台类型默认参数。